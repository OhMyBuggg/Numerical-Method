clear all;
t = 0;
x = [0; 1; 0];

f = @(t,x)[x(2); x(3); t + 2*x(1) - t*x(2)];

[t,x] = ode45(f,[0, 0.2, 0.4, 0.6], x);
f06 = 55 * f(0.6,[x(4,1); x(4,2); x(4,3)]);
f04 = 59 * f(0.4,[x(3,1); x(3,2); x(3,3)]);
f02 = 37 * f(0.2,[x(2,1); x(2,2); x(2,3)]);
f0 = 9 * f(0,[x(1,1); x(1,2); x(1,3)]);
step1 = [x(4,1); x(4,2); x(4,3)] + 0.2/24*(f06-f04+f02-f0);
f08 = 9 * f(0.8, step1);
f06 = 19 * f(0.6, [x(4,1); x(4,2); x(4,3)]);
f04 = -5 * f(0.4,[x(3,1); x(3,2); x(3,3)]);
f02 = f(0.2,[x(2,1); x(2,2); x(2,3)]);
step1 = [x(4,1); x(4,2); x(4,3)] + 0.2/24*(f08 + f06 + f04 + f02);

f08 = 55 * f(0.8,step1);
f06 = 59 * f(0.6,[x(4,1); x(4,2); x(4,3)]);
f04 = 37 * f(0.4,[x(3,1); x(3,2); x(3,3)]);
f02 = 9 * f(0.2,[x(2,1); x(2,2); x(2,3)]);
ans = step1 + 0.2/24*(f08-f06+f04-f02);
f10 = 9 * f(1,ans);
f08 = 19 * f(0.8,step1);
f06 = -5 * f(0.6,[x(4,1); x(4,2); x(4,3)]);
f04 = f(0.4,[x(3,1); x(3,2); x(3,3)]);
ans = step1 + 0.2/24*(f10 + f08 + f06 +f04);

t = 0;
x = [0; 1; 0];
[t,x] = ode45(f,[0, 0.2, 0.4, 0.6, 0.8, 1], x);

accruacy = [x(6,1); x(6,2); x(6,3)] + abs([x(6,1); x(6,2); x(6,3)] - ans)/3;